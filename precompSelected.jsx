//Snippet to precomp all selected layers into separate comps//CC-BY, Nik Ska, 2014var precompSelected = this;precompSelected.go = function(_moveAllAttributes){	var activeComp = app.project.activeItem;	if(activeComp && activeComp instanceof CompItem){		var sel = activeComp.selectedLayers;		if(sel){			app.beginUndoGroup("Batch Precomp");			//sort selection by index			sel = sel.sort(function(a,b){				return (b.index - a.index)			});			for(var s = sel.length-1; s>=0; s--){				//check for Text of Shape layers				if(sel[s] instanceof ShapeLayer || sel[s] instanceof TextLayer) move = true;				else move = _moveAllAttributes;				var p = activeComp.layers.precompose([sel[s].index], sel[s].name+"_precomp", move);				p.parentFolder = activeComp.parentFolder;			}			app.endUndoGroup();		}	}}precompSelected.go(false)